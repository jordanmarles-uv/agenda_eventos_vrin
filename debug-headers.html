<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Headers - Google Sheets</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; }
        .header { background: #e3f2fd; padding: 10px; margin: 5px 0; border-radius: 5px; }
        .row { background: #f5f5f5; padding: 10px; margin: 5px 0; border-radius: 5px; font-family: monospace; font-size: 12px; }
        .success { background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; }
        .error { background: #f8d7da; color: #721c24; padding: 15px; border-radius: 5px; }
        .warning { background: #fff3cd; color: #856404; padding: 15px; border-radius: 5px; }
    </style>
</head>
<body>
    <h1>üîç Debug Headers - Google Sheets</h1>
    
    <div id="results"></div>
    
    <script src="config.js"></script>
    <script src="google-sheets-config.js"></script>
    <script>
        async function debugHeaders() {
            const results = document.getElementById('results');
            
            try {
                results.innerHTML = '<div class="warning">üîÑ Cargando headers...</div>';
                
                // Cargar datos
                const config = SHEETS_CONFIG;
                const url = `https://sheets.googleapis.com/v4/spreadsheets/${config.spreadsheetId}/values/${encodeURIComponent(config.sheetName)}?key=${config.options.apiKey}`;
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                
                if (!data.values || data.values.length === 0) {
                    results.innerHTML = '<div class="error">‚ùå No hay datos en el sheet</div>';
                    return;
                }
                
                // Mostrar headers
                const headers = data.values[0];
                let html = '<h2>üìã Headers Encontrados:</h2>';
                
                headers.forEach((header, index) => {
                    html += `
                        <div class="header">
                            <strong>Columna ${index} (${String.fromCharCode(65 + index)}):</strong> 
                            "${header || '(vac√≠o)'}"
                        </div>
                    `;
                });
                
                // Mostrar primeras filas de datos
                html += '<h2>üìä Primeras Filas de Datos:</h2>';
                data.values.slice(0, 6).forEach((row, index) => {
                    html += `
                        <div class="row">
                            <strong>Fila ${index}:</strong> 
                            ${row.map(cell => `"${cell || ''}"`).join(' | ')}
                        </div>
                    `;
                });
                
                // An√°lisis
                html += '<h2>üîç An√°lisis:</h2>';
                
                const expectedHeaders = ['titulo', 'descripcion', 'fecha', 'hora', 'duracion', 'area', 'tipo', 'dirigido_a', 'imagen', 'enlace', 'estado', 'responsable'];
                const foundHeaders = [];
                
                headers.forEach((header, index) => {
                    if (header) {
                        const normalized = header.toLowerCase().trim();
                        expectedHeaders.forEach(expected => {
                            if (normalized.includes(expected)) {
                                foundHeaders.push(`${expected} -> Columna ${index} ("${header}")`);
                            }
                        });
                    }
                });
                
                if (foundHeaders.length > 0) {
                    html += '<div class="success"><h3>‚úÖ Headers Detectados:</h3><ul>';
                    foundHeaders.forEach(found => {
                        html += `<li>${found}</li>`;
                    });
                    html += '</ul></div>';
                } else {
                    html += '<div class="error"><h3>‚ùå No se detectaron headers esperados</h3>';
                    html += '<p>Los headers deben incluir palabras como: titulo, descripcion, fecha, hora, etc.</p></div>';
                }
                
                results.innerHTML = html;
                
            } catch (error) {
                results.innerHTML = `<div class="error">‚ùå Error: ${error.message}</div>`;
            }
        }
        
        debugHeaders();
    </script>
</body>
</html>
