<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validar Spreadsheet ID</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .input-group { margin: 20px 0; }
        input { width: 100%; padding: 10px; font-size: 16px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        .result { margin: 20px 0; padding: 15px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>üîç Validar Spreadsheet ID</h1>
    
    <div class="info">
        <h3>üìã Instrucciones:</h3>
        <p>1. Abre tu Google Sheet</p>
        <p>2. Copia el ID de la URL (ej: https://docs.google.com/spreadsheets/d/<strong>ESTE_ES_EL_ID</strong>/edit)</p>
        <p>3. P√©galo en el campo below</p>
    </div>
    
    <div class="input-group">
        <label for="sheetId">Spreadsheet ID:</label>
        <input type="text" id="sheetId" placeholder="1kjYUKG-ERUyu_qjmuKDUkJiBGUajIdUF" value="1kjYUKG-ERUyu_qjmuKDUkJiBGUajIdUF">
    </div>
    
    <button onclick="validateSheet()">Validar Spreadsheet</button>
    
    <div id="results"></div>
    
    <script>
        const apiKey = 'AIzaSyBVzq74cE3qC5nNVH--0mfjdSX7w7NP-a4';
        
        async function validateSheet() {
            const sheetId = document.getElementById('sheetId').value.trim();
            const results = document.getElementById('results');
            
            if (!sheetId) {
                results.innerHTML = '<div class="error">‚ùå Por favor ingresa un Spreadsheet ID</div>';
                return;
            }
            
            results.innerHTML = '<div class="info">üîÑ Validando...</div>';
            
            try {
                // Test 1: Verificar si el spreadsheet existe
                const metaUrl = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}?key=${apiKey}`;
                const response = await fetch(metaUrl);
                
                if (response.status === 404) {
                    results.innerHTML = `
                        <div class="error">‚ùå Spreadsheet no encontrado (404)</div>
                        <div class="info">
                            <h3>üîß Soluci√≥n:</h3>
                            <p>1. Verifica que el ID sea correcto</p>
                            <p>2. Aseg√∫rate que el Sheet est√© compartido p√∫blicamente</p>
                            <p>3. Verifica que sea un Google Sheet v√°lido</p>
                        </div>
                    `;
                    return;
                }
                
                if (response.status === 403) {
                    results.innerHTML = `
                        <div class="error">‚ùå Acceso denegado (403)</div>
                        <div class="info">
                            <h3>üîß Soluci√≥n:</h3>
                            <p>1. Comparte el Sheet: "Cualquier persona con el enlace puede ver"</p>
                            <p>2. Verifica que la API Key sea v√°lida</p>
                        </div>
                    `;
                    return;
                }
                
                if (!response.ok) {
                    const error = await response.json();
                    results.innerHTML = `
                        <div class="error">‚ùå Error ${response.status}: ${error.error?.message || 'Unknown error'}</div>
                    `;
                    return;
                }
                
                const data = await response.json();
                
                results.innerHTML = `
                    <div class="success">‚úÖ Spreadsheet v√°lido encontrado!</div>
                    <div class="info">
                        <h3>üìä Informaci√≥n:</h3>
                        <p><strong>T√≠tulo:</strong> ${data.properties?.title || 'N/A'}</p>
                        <p><strong>Hojas disponibles:</strong></p>
                        <ul>
                            ${data.sheets?.map(sheet => `<li>${sheet.properties?.title}</li>`).join('') || '<li>No hay hojas</li>'}
                        </ul>
                    </div>
                `;
                
                // Actualizar configuraci√≥n autom√°ticamente
                updateConfig(sheetId);
                
            } catch (error) {
                results.innerHTML = `
                    <div class="error">‚ùå Error de conexi√≥n: ${error.message}</div>
                    <div class="info">
                        <h3>üîß Posibles soluciones:</h3>
                        <p>1. Verifica tu conexi√≥n a internet</p>
                        <p>2. Intenta con un Spreadsheet ID diferente</p>
                        <p>3. Revisa la consola para m√°s detalles</p>
                    </div>
                `;
            }
        }
        
        function updateConfig(newSheetId) {
            // Actualizar google-sheets-config.js
            console.log('üîß Actualizando configuraci√≥n con nuevo Spreadsheet ID:', newSheetId);
        }
        
        // Validar autom√°ticamente al cargar
        window.onload = () => validateSheet();
    </script>
</body>
</html>
